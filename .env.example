# ImageFlow 环境配置示例文件
# 复制此文件为 .env 并根据您的需求修改配置

# =============================================================================
# 🚀 服务器配置
# =============================================================================

# 服务器监听地址和端口
SERVER_ADDR=:8686

# 调试模式
DEBUG_MODE=false

# =============================================================================
# 🔐 认证配置
# =============================================================================

# 认证类型: api_key | oidc (推荐使用 oidc)
AUTH_TYPE=oidc

# API Key 认证 (向后兼容，当 AUTH_TYPE=api_key 时使用)
API_KEY=your-api-key-here

# OIDC 认证配置 (当 AUTH_TYPE=oidc 时使用)
OIDC_ISSUER=https://accounts.google.com
OIDC_CLIENT_ID=your-google-client-id.googleusercontent.com
OIDC_CLIENT_SECRET=your-google-client-secret
OIDC_REDIRECT_URL=http://localhost:8686/auth/callback
OIDC_SCOPES=openid,profile,email

# JWT 签名密钥 (用于会话令牌签名，请使用强密码)
JWT_SIGNING_KEY=your-very-secret-jwt-signing-key-must-be-at-least-32-characters

# =============================================================================
# 🗄️ 存储配置
# =============================================================================

# 存储类型: local | s3
STORAGE_TYPE=local

# 本地存储路径 (当 STORAGE_TYPE=local 时使用)
LOCAL_STORAGE_PATH=static/images

# 自定义域名 (可选，用于图片 URL)
CUSTOM_DOMAIN=

# =============================================================================
# 📊 元数据存储配置
# =============================================================================

# 元数据存储类型: redis (目前仅支持 redis)
METADATA_STORE_TYPE=redis

# =============================================================================
# 🔴 Redis 配置
# =============================================================================

# Redis 服务器地址
REDIS_HOST=localhost

# Redis 服务器端口
REDIS_PORT=6379

# Redis 密码 (如果有的话)
REDIS_PASSWORD=

# Redis 数据库编号
REDIS_DB=0

# 是否启用 Redis TLS 连接
REDIS_TLS_ENABLED=false

# =============================================================================
# ☁️ S3 配置 (当 STORAGE_TYPE=s3 时使用)
# =============================================================================

# 是否启用 S3 存储
S3_ENABLED=false

# S3 端点 URL (对于 AWS S3，通常留空)
S3_ENDPOINT=

# S3 区域
S3_REGION=us-east-1

# S3 存储桶名称
S3_BUCKET=your-bucket-name

# S3 访问密钥
S3_ACCESS_KEY=your-s3-access-key

# S3 密钥
S3_SECRET_KEY=your-s3-secret-key

# 是否强制使用路径样式 (某些 S3 兼容存储需要)
S3_FORCE_PATH_STYLE=true

# =============================================================================
# ⚙️ 图片处理配置
# =============================================================================

# 单次上传最大图片数量
MAX_UPLOAD_COUNT=20

# 图片质量 (1-100，建议 80-90)
IMAGE_QUALITY=80

# 处理线程数 (建议设置为 CPU 核心数)
WORKER_THREADS=4

# 编码速度 (0-8，0=最慢/最高质量，8=最快/较低质量)
SPEED=5

# 工作池大小 (并发图片处理任务数)
WORKER_POOL_SIZE=10

# =============================================================================
# 🧹 清理配置
# =============================================================================

# 清理间隔 (分钟)
CLEANUP_INTERVAL=60

# =============================================================================
# 💡 配置说明
# =============================================================================

# 1. OIDC 认证配置
#    - 支持 Google、Auth0、Azure AD 等 OIDC 提供商
#    - OIDC_ISSUER: 提供商的发现端点 URL
#    - OIDC_CLIENT_ID/SECRET: 在 OIDC 提供商处注册应用获得
#    - OIDC_REDIRECT_URL: 必须与提供商配置的重定向 URL 一致

# 2. 存储选择
#    - local: 图片存储在服务器本地文件系统
#    - s3: 图片存储在 S3 兼容的对象存储 (AWS S3, MinIO 等)

# 3. Redis 配置
#    - 用于存储图片元数据、用户信息和索引
#    - 如使用 Redis Cloud 或 Upstash，需要配置 TLS

# 4. 性能调优
#    - IMAGE_QUALITY: 较高值获得更好质量，但文件更大
#    - WORKER_THREADS: 根据 CPU 核心数调整
#    - SPEED: 根据需求在质量和速度间平衡
